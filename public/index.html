<!doctype html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ðŸ“Œ API Status & Informasi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
    <style>
        body {
            background-color: #3c3f41;
            color: #d7dadc;
            font-family: 'Press Start 2P', cursive;
        }

        header {
            background-color: #4a7c56;
            padding: 4rem 0;
            color: #fff;
            border-bottom: 2px solid #5a9c6e;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .info-box {
            background-color: #282a2e;
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .loading {
            color: #aaa;
            font-style: italic;
        }

        footer {
            background-color: #4a7c56;
            padding: 1rem 0;
            color: #d7dadc;
            border-top: 2px solid #5a9c6e;
            font-size: 1rem;
        }
    </style>
</head>

<body>

    <!-- Header Section -->
    <header class="text-center">
        <h1>ðŸ“Œ Status & Informasi API</h1>
        <p class="lead mt-3">Monitor performa server & status API secara real-time</p>
    </header>

    <!-- Status API -->
    <section id="status" class="container py-5 text-center">
        <h2>ðŸ“Œ Informasi API</h2>
        <div class="info-box">
            <p><b>Nama API:</b> <span id="api-name" class="loading">Memuat...</span></p>
            <p><b>Versi:</b> <span id="api-version" class="loading">Memuat...</span></p>
            <p><b>Uptime:</b> <span id="api-uptime" class="loading">Memuat...</span></p>
            <p><b>Total Endpoint:</b> <span id="api-endpoints" class="loading">Memuat...</span></p>
            <p><b>Hostname:</b> <span id="server-hostname" class="loading">Memuat...</span></p>
            <p><b>Port:</b> <span id="server-port" class="loading">Memuat...</span></p>
            <p><b>Waktu Server:</b> <span id="server-time" class="loading">Memuat...</span></p>
        </div>

        <h2 class="mt-5">ðŸ“Š Status Server</h2>
        <div class="info-box">
            <p><b>CPU Load:</b> 
                <span id="cpu-load-1m" class="loading">Memuat...</span> (1 min) | 
                <span id="cpu-load-5m" class="loading">Memuat...</span> (5 min) | 
                <span id="cpu-load-15m" class="loading">Memuat...</span> (15 min)
            </p>
            <p><b>Total RAM:</b> <span id="total-ram" class="loading">Memuat...</span></p>
            <p><b>RAM Tersisa:</b> <span id="free-ram" class="loading">Memuat...</span></p>
            <p><b>Disk Usage:</b> <span id="disk-usage" class="loading">Memuat...</span></p>
        </div>

        <h2 class="mt-5">ðŸ“¡ Statistik API</h2>
        <div class="info-box">
            <p><b>Jumlah Request:</b> <span id="total-requests" class="loading">Memuat...</span></p>
            <p><b>Request per Detik:</b> <span id="req-per-sec" class="loading">Memuat...</span></p>
            <p><b>Status Database:</b> <span id="db-status" class="loading">Memuat...</span></p>
        </div>
    </section>

    <!-- Footer -->
    <footer class="text-center">
        <p>&copy; 2025 API Documentation. Semua Hak Dilindungi.</p>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>

    <!-- Fetch API Info & Status -->
    <script>
        async function fetchAPIInfo() {
            try {
                const [infoRes, statusRes] = await Promise.all([
                    fetch("/api/info"),
                    fetch("/api/status")
                ]);

                const infoData = await infoRes.json();
                const statusData = await statusRes.json();

                // API Info
                document.getElementById("api-name").textContent = infoData.server.name;
                document.getElementById("api-version").textContent = infoData.server.version;
                document.getElementById("api-uptime").textContent = infoData.server.uptime;
                document.getElementById("api-endpoints").textContent = infoData.server.totalEndpoints;
                document.getElementById("server-hostname").textContent = infoData.server.hostname;
                document.getElementById("server-port").textContent = infoData.server.port;
                document.getElementById("server-time").textContent = new Date(infoData.server.time).toLocaleString();

                // Server Status
                document.getElementById("cpu-load-1m").textContent = statusData.server.cpuLoad["1m"];
                document.getElementById("cpu-load-5m").textContent = statusData.server.cpuLoad["5m"];
                document.getElementById("cpu-load-15m").textContent = statusData.server.cpuLoad["15m"];
                document.getElementById("total-ram").textContent = statusData.server.totalMemory;
                document.getElementById("free-ram").textContent = statusData.server.freeMemory;
                document.getElementById("disk-usage").textContent = statusData.server.diskUsage;

                // API Statistics
                document.getElementById("total-requests").textContent = statusData.api.totalRequests;
                document.getElementById("req-per-sec").textContent = statusData.api.requestsPerSecond;
                document.getElementById("db-status").textContent = statusData.database.status;

            } catch (error) {
                console.error("Gagal mengambil data API:", error);
            }
        }

        // Update setiap 10 detik
        fetchAPIInfo();
        setInterval(fetchAPIInfo, 10000);
    </script>

</body>
</html>